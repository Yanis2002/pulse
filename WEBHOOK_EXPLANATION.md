# Как работает Webhook для Telegram бота

## Что такое Webhook?

Webhook - это механизм, через который Telegram отправляет обновления (сообщения, команды) вашему серверу в реальном времени.

## Как это работает:

1. **Настройка Webhook:**
   - Вы настраиваете webhook через админ-панель (кнопка "⚙ НАСТРОИТЬ WEBHOOK ДЛЯ БОТА")
   - URL webhook: `https://ваш-домен.ru/api/telegram/webhook`
   - Telegram сохраняет этот URL и будет отправлять туда все обновления

2. **Когда пользователь отправляет /start:**
   - Telegram получает команду `/start` от пользователя
   - Telegram отправляет POST-запрос на ваш webhook URL с данными об обновлении
   - Ваш сервер получает запрос на `/api/telegram/webhook`
   - Функция `api_telegram_webhook()` обрабатывает запрос
   - Вызывается `process_webhook_update()` из модуля `telegram_bot.py`
   - Если это команда `/start`, вызывается `handle_start_command()`
   - Бот регистрирует пользователя в базе данных и отправляет приветственное сообщение

3. **Поток данных:**
   ```
   Пользователь → Telegram → Webhook → /api/telegram/webhook → 
   process_webhook_update() → handle_start_command() → 
   Регистрация в БД + Отправка приветствия
   ```

## Важно:

- Webhook нужно настроить **один раз** через админ-панель
- После настройки бот автоматически получает все обновления
- Если webhook не настроен, бот не будет получать команды и не сможет отвечать

## Проверка webhook:

- Откройте админ-панель
- Нажмите "⚙ НАСТРОИТЬ WEBHOOK ДЛЯ БОТА"
- После успешной настройки бот начнет получать обновления

